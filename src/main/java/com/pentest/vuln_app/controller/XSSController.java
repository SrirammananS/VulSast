package com.pentest.vuln_app.controller;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;

@Controller
public class XSSController {

    // ❌ Vulnerable to reflected XSS
    @GetMapping("/xss-vuln")
    public String xssVulnerable(@RequestParam(required = false) String input, Model model) {
        model.addAttribute("input", input);
        return "xss-vuln";
    }

    // ✅ Safe against XSS
    @GetMapping("/xss-safe")
    public String xssSafe(@RequestParam(required = false) String input, Model model) {
        model.addAttribute("input", input);
        return "xss-safe";
    }
}
